auth.onAuthStateChanged(e=>{if(e){const t=document.getElementById("droparea"),l=document.getElementById("uploadmodel"),i=document.getElementById("uploadtext"),n=document.getElementById("profilepicture");let o=!1;n.addEventListener("click",function(){document.getElementById("uploadimagep").style.display="flex",o=!0}),document.getElementById("Everythingelse").style.display="block",t.addEventListener("dragover",function(e){e.preventDefault(),l.classList.add("hover")}),t.addEventListener("dragleave",function(){l.classList.remove("hover")}),t.addEventListener("drop",function(e){e.preventDefault();let t=e.dataTransfer.files[0],n=t.type.split("/");if(l.classList.remove("hover"),"image"==n[0])return d(t);i.innerText="Invalid file!"});const d=t=>{i.innerText=t.name;const l=new FileReader;l.readAsDataURL(t),l.onload=(()=>{let t=l.result;if(1==o)document.getElementById("uploadimagep").style.display="none",firestore.collection("users").doc(e.uid).update({Profile:t}),document.getElementById("profilepicture").src=t,o=!1;else{document.getElementById("uploadimagep").style.display="none",firestore.collection("users").doc(e.uid).get().then(e=>{const l=e.data();let i=`<div id="message" style="margin-top:5px;float:right; clear:both; display:inline-block;  margin-right:10px;">\n                    <img style="display:inline-block; width:100px; height:150px; border-radius:14px; margin-left:10px; margin-top:10px; " src="${t}">\n                    <img style = "float:right; clear:both; width: 40px; height: 40px; display: inline-block; border-radius:50px;margin-left:10px;   " src="${l.Profile}"></div>`;document.getElementById("chatiy").innerHTML+=i;var n=document.getElementById("chatiy");n.scrollTop=n.scrollHeight}),firestore.collection(localStorage.getItem("cth")).doc("Messages").update({Type:"Img",ImageSrc:t,WhoIsTheMessageFrom:e.uid});let l=-(new Date).getTime();firestore.collection(localStorage.getItem("cth")).doc(String(l)).set({Type:"Img",IsMessage:!1,ImageSrc:t,WhoIsTheMessageFrom:e.uid})}})}}});